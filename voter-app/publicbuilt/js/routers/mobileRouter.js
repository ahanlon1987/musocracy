define(["jquery","backbone","amplify","../collections/SearchCollection","../collections/QueueCollection","../views/SearchView","../views/QueueView","../views/LocationView","../util/persist"],function(e,t,n,r,i,s,o,u,a){var f=t.Router.extend({initialize:function(){this.locationView=new u({el:"#container-wrapper"}),this.searchView=new s({el:"#container-wrapper",collection:new r}),this.queueView=new o({el:"#votes",collection:new i}),t.history.start(),this.persist=a},amplify:n,routes:{"":"home",queue:"queue",search:"search","search?:query":"search",location:"enterLocation"},home:function(){amplify.store("locationId")?window.location.href="#queue":this.enterLocation()},enterLocation:function(){this.locationView.render()},queue:function(){if(!amplify.store("locationId"))this.enterLocation();else{var e=this.queueView;e.collection.url="/location/"+amplify.store("locationId")+"/votes",e.collection.fetch().done(function(){})}},search:function(e){if(!amplify.store("locationId"))this.enterLocation();else{var t=this.searchView;e?(t.collection.url="/search/track?q="+e,t.collection.fetch().done(function(){})):t.collection.isEmpty()?t.collection.reset():t.render()}}});return f});