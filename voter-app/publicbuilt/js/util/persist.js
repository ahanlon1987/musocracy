define(["jquery","underscore","backbone","amplify"],function(e,t,n,r){var i={amplify:r,vote:function(n,r){var i=n.get("trackId"),s=n.get("name"),o=n.get("artists"),u=n.get("album");console.log("Voting for trackId: "+i+", trackName: "+s+", artists: "+o+", album: "+u);var a=amplify;e.ajax({type:"POST",url:"/location/"+amplify.store("locationId")+"/votes/"+i,data:{trackId:i,name:s,artists:o,album:u},success:function(e){var n=a.store("previousVotes")||[];n.push({trackId:i,voteTime:new Date}),a.store("previousVotes",n),r&&t.isFunction(r.success)&&r.success(e)},failure:function(){console.log("voting failed.")},dataType:"json"})},lookupLocation:function(t){e.ajax({type:"GET",url:"/location/"+t,data:{},success:function(n){console.log("200 returned from location service, check if locationId is null"),n?(console.log("found location: "+n.locationId),amplify.store("locationId",n.locationId,{expires:216e5}),e("#location-submit").addClass("hidden"),window.location.href="#"):(console.log("No such location: "+t),e("label#location-label").html("Unable to find a location of "+t+"."))},failure:function(){console.log("Error trying to find location "+t+", please try again")},dataType:"json"})}};return i});